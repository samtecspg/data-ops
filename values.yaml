##  Note that helm by default only runs the daskhub specification of jupyterhub
##  Overrides here are to ensure that the livy version still runs properly
##  And adds profile list to switch between the underlying images

daskhub:
  jupyterhub:
    singleuser:
      storage:
        capacity: 2Gi
        homeMountPath: /home/jovyan/notebooks

      profileList:
      # https://jupyter-docker-stacks.readthedocs.io/en/latest/using/specifics.html#apache-spark
      - display_name: "Combined Image"
        description: "Sparkmagic + Daskgateway"
        default: True
        kubespawner_override:
          environment:
            # For Sparkmagic Kernel
            LIVY_ENDPOINT: "http://livy-server:80"
          cmd:
          - "/opt/singleuser-entrypoint.sh"
          - "--NotebookApp.notebook_dir=/home/jovyan/notebooks"
          image: "kprifogle/base-notebook:0.0.6"
      - display_name: "Spark Notebooks"
        description: "Sparkmagic kernel"
        default: False
        # https://jupyterhub-kubespawner.readthedocs.io/en/latest/spawner.html#kubespawner.KubeSpawner
        kubespawner_override:
          environment:
            # For Sparkmagic Kernel
            LIVY_ENDPOINT: "http://livy-server:80"
          cmd:
          - "/opt/singleuser-entrypoint.sh"
          - "--NotebookApp.notebook_dir=/home/jovyan/notebooks"
          image: "sasnouskikh/jupyter:4.6.3-sparkmagic_0.15.0"
      - display_name: "Dask Notebooks"
        description: "Daskhub Notebook"
        default: False
        kubespawner_override:
          image: "pangeo/base-notebook:2020.11.06"
      # defaultUrl: "/lab"
